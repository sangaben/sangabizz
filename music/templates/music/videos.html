{% extends "base.html" %}
{% load static %}

{% block title %}Music Videos - Sangabiz{% endblock %}

{% block content %}
<!-- Hero Section with Video Background -->
<div class="hero-video-section">
    <!-- Video Background -->
    <video autoplay muted loop playsinline class="hero-video-bg">
        <source src="{% static 'videos/music-hero-bg.mp4' %}" type="video/mp4">
        <source src="{% static 'videos/music-hero-bg.webm' %}" type="video/webm">
        <!-- Fallback image if video doesn't load -->
        <img src="{% static 'images/hero-bg.jpg' %}" alt="Music Videos Background">
    </video>
    
    <!-- Video Overlay -->
    <div class="video-overlay-gradient"></div>
    
    <!-- Hero Content -->
    <div class="hero-content">
        <div class="container">
            <h1 class="hero-title">Music Videos</h1>
            <p class="hero-subtitle">Watch the latest music videos, exclusive content, and trending performances</p>
            
            <!-- Search Bar -->
            <div class="search-videos">
                <div class="search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" id="video-search" placeholder="Search videos..." onkeyup="filterVideos()">
                </div>
            </div>
            
            <!-- Play/Pause Video Toggle -->
            <div class="video-controls">
                <button class="video-control-btn" onclick="toggleHeroVideo()">
                    <i class="fas fa-pause" id="videoControlIcon"></i>
                    <span id="videoControlText">Pause Background</span>
                </button>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <!-- Rest of your content remains the same -->
    <!-- Video Categories -->
    <section class="video-categories">
        <div class="categories-header">
            <h2 class="section-title">Browse Videos</h2>
            <div class="category-filters">
                <button class="category-filter active" data-category="all">All Videos</button>
                <button class="category-filter" data-category="featured">Featured</button>
                <button class="category-filter" data-category="trending">Trending</button>
                <button class="category-filter" data-category="new">New Releases</button>
            </div>
        </div>
    </section>

    <!-- Featured Videos Section -->
    {% if featured_videos %}
    <section class="featured-videos-section">
        <h3 class="section-title">
            <i class="fas fa-star"></i>
            Featured Videos
        </h3>
        <div class="featured-videos-grid">
            {% for video in featured_videos %}
            <div class="featured-video-card" data-category="featured" data-title="{{ video.title|lower }}">
                <div class="video-thumbnail-large">
                    <img src="{{ video.thumbnail_url }}" alt="{{ video.title }}" onerror="this.src='{% static 'images/default-video.jpg' %}'">
                    <div class="video-overlay">
                        <div class="play-button-large" onclick="playFeaturedVideo('{{ video.youtube_id }}', '{{ video.title|escapejs }}')">
                            <i class="fas fa-play"></i>
                        </div>
                        <div class="video-duration">3:45</div>
                    </div>
                </div>
                <div class="video-info-large">
                    <h4 class="video-title">{{ video.title }}</h4>
                    <p class="video-description">{{ video.description|truncatewords:20 }}</p>
                    <div class="video-meta">
                        <span class="video-views">
                            <i class="far fa-eye"></i>
                            {{ video.views|default:"0" }} views
                        </span>
                        <span class="video-date">
                            <i class="far fa-calendar"></i>
                            {{ video.added_date|date:"M d, Y" }}
                        </span>
                    </div>
                    <div class="video-actions">
                        <button class="video-action-btn like-btn" onclick="likeVideo({{ video.id }})">
                            <i class="far fa-thumbs-up"></i>
                            <span>{{ video.likes|default:"0" }}</span>
                        </button>
                        <button class="video-action-btn share-btn" onclick="shareVideo('{{ video.youtube_id }}', '{{ video.title|escapejs }}')">
                            <i class="fas fa-share"></i>
                            Share
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
    {% endif %}

    <!-- All Videos Grid -->
    <section class="all-videos-section">
        <div class="section-header">
            <h3 class="section-title">
                <i class="fas fa-play-circle"></i>
                All Videos
            </h3>
            <div class="sort-options">
                <select id="video-sort" onchange="sortVideos(this.value)">
                    <option value="newest">Newest First</option>
                    <option value="oldest">Oldest First</option>
                    <option value="popular">Most Popular</option>
                    <option value="title">Title A-Z</option>
                </select>
            </div>
        </div>

        <div class="videos-grid" id="videos-grid">
            {% for video in all_videos %}
            <div class="video-card" data-category="all" data-title="{{ video.title|lower }}" data-date="{{ video.added_date|date:'Y-m-d' }}" data-views="{{ video.views|default:0 }}">
                <div class="video-thumbnail">
                    <img src="{{ video.thumbnail_url }}" alt="{{ video.title }}" onerror="this.src='{% static 'images/default-video.jpg' %}'">
                    <div class="video-overlay">
                        <div class="play-button" onclick="playVideo('{{ video.youtube_id }}', '{{ video.title|escapejs }}')">
                            <i class="fas fa-play"></i>
                        </div>
                        <div class="video-duration">3:45</div>
                    </div>
                    {% if video.is_featured %}
                    <div class="featured-badge">
                        <i class="fas fa-star"></i>
                        Featured
                    </div>
                    {% endif %}
                </div>
                <div class="video-info">
                    <h4 class="video-title" title="{{ video.title }}">{{ video.title }}</h4>
                    <p class="video-description">{{ video.description|truncatewords:15 }}</p>
                    <div class="video-meta">
                        <span class="video-views">
                            <i class="far fa-eye"></i>
                            {{ video.views|default:"0" }} views
                        </span>
                        <span class="video-date">
                            {{ video.added_date|timesince }} ago
                        </span>
                    </div>
                </div>
            </div>
            {% empty %}
            <div class="no-videos">
                <i class="fas fa-video-slash"></i>
                <h4>No Videos Available</h4>
                <p>Check back later for new music videos!</p>
                {% if user.is_staff %}
                <a href="/admin/music/youtubevideo/add/" class="primary-btn">
                    <i class="fas fa-plus"></i> Add Video
                </a>
                {% endif %}
            </div>
            {% endfor %}
        </div>

        <!-- Load More Button -->
        {% if all_videos.has_next %}
        <div class="load-more-videos">
            <button class="load-more-btn" onclick="loadMoreVideos()">
                <i class="fas fa-spinner fa-spin" id="load-more-spinner" style="display: none;"></i>
                Load More Videos
            </button>
        </div>
        {% endif %}
    </section>

    <!-- Popular Artists in Videos -->
    <section class="video-artists">
        <h3 class="section-title">
            <i class="fas fa-users"></i>
            Featured Artists
        </h3>
        <div class="artists-carousel">
            {% for artist in featured_artists %}
            <div class="artist-video-card">
                <div class="artist-image">
                    {% if artist.image %}
                        <img src="{{ artist.image.url }}" alt="{{ artist.name }}">
                    {% else %}
                        <div class="artist-placeholder">
                            <i class="fas fa-user"></i>
                        </div>
                    {% endif %}
                </div>
                <div class="artist-info">
                    <h5>{{ artist.name }}</h5>
                    <p>{{ artist.genre.name|default:"Music" }}</p>
                    <button class="view-artist-btn" onclick="viewArtist({{ artist.id }})">
                        View Profile
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
    </section>
</div>

<!-- Video Player Modal -->
<div class="video-player-modal" id="video-player-modal">
    <div class="video-player-container">
        <div class="video-player-header">
            <h3 id="video-player-title">Video Title</h3>
            <button class="close-player-btn" onclick="closeVideoPlayer()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="video-player-content">
            <div class="youtube-player-container">
                <iframe id="youtube-player" width="100%" height="100%" 
                        src="" frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                </iframe>
            </div>
            <div class="video-player-info">
                <div class="player-actions">
                    <button class="player-action-btn like-btn" id="player-like-btn">
                        <i class="far fa-thumbs-up"></i>
                        <span id="player-likes">0</span>
                    </button>
                    <button class="player-action-btn share-btn" onclick="shareCurrentVideo()">
                        <i class="fas fa-share"></i>
                        Share
                    </button>
                    <button class="player-action-btn download-btn" onclick="downloadVideo()">
                        <i class="fas fa-download"></i>
                        Download
                    </button>
                </div>
                <div class="video-description-full" id="player-description">
                    Video description will appear here...
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Video Share Modal -->
<div class="share-modal" id="share-modal">
    <div class="share-modal-content">
        <div class="share-modal-header">
            <h4>Share Video</h4>
            <button class="close-share-btn" onclick="closeShareModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="share-options">
            <button class="share-option facebook" onclick="shareOnFacebook()">
                <i class="fab fa-facebook-f"></i>
                Facebook
            </button>
            <button class="share-option twitter" onclick="shareOnTwitter()">
                <i class="fab fa-twitter"></i>
                Twitter
            </button>
            <button class="share-option whatsapp" onclick="shareOnWhatsApp()">
                <i class="fab fa-whatsapp"></i>
                WhatsApp
            </button>
            <button class="share-option copy-link" onclick="copyVideoLink()">
                <i class="fas fa-link"></i>
                Copy Link
            </button>
        </div>
        <div class="share-link-container">
            <input type="text" id="share-link-input" readonly>
            <button class="copy-btn" onclick="copyVideoLink()">
                <i class="fas fa-copy"></i>
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
/* Hero Video Section */
.hero-video-section {
    position: relative;
    height: 80vh;
    min-height: 600px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
}

.hero-video-bg {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    min-width: 100%;
    min-height: 100%;
    width: auto;
    height: auto;
    z-index: -2;
    object-fit: cover;
}

/* Video Overlay */
.video-overlay-gradient {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
        135deg,
        rgba(108, 92, 231, 0.85) 0%,
        rgba(253, 121, 168, 0.75) 50%,
        rgba(69, 104, 220, 0.85) 100%
    );
    z-index: -1;
}

/* Hero Content */
.hero-content {
    position: relative;
    z-index: 1;
    text-align: center;
    color: white;
    width: 100%;
    padding: 0 20px;
}

.hero-title {
    font-size: clamp(2.5rem, 6vw, 4rem);
    font-weight: 800;
    margin-bottom: 1rem;
    text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
    background: linear-gradient(135deg, #fff 0%, #f0f0f0 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.hero-subtitle {
    font-size: clamp(1.1rem, 2.5vw, 1.5rem);
    margin-bottom: 2.5rem;
    text-shadow: 1px 1px 4px rgba(0,0,0,0.5);
    opacity: 0.95;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    line-height: 1.4;
}

/* Search Bar */
.search-videos {
    margin-top: 2rem;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
}

.search-videos .search-bar {
    background: rgba(255, 255, 255, 0.95);
    border-radius: 50px;
    padding: 15px 25px;
    display: flex;
    align-items: center;
    gap: 15px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.2);
}

.search-videos .search-bar input {
    background: transparent;
    border: none;
    outline: none;
    color: #333;
    width: 100%;
    font-size: 16px;
    font-weight: 500;
}

.search-videos .search-bar input::placeholder {
    color: #666;
}

.search-videos .search-bar i {
    color: var(--primary);
    font-size: 18px;
}

/* Video Controls */
.video-controls {
    margin-top: 2rem;
}

.video-control-btn {
    background: rgba(255, 255, 255, 0.2);
    color: white;
    border: 2px solid rgba(255,255,255,0.3);
    padding: 10px 20px;
    border-radius: 25px;
    cursor: pointer;
    transition: var(--transition);
    font-size: 14px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    backdrop-filter: blur(10px);
}

.video-control-btn:hover {
    background: rgba(255, 255, 255, 0.3);
    border-color: rgba(255,255,255,0.5);
    transform: translateY(-2px);
}

/* Rest of your existing CSS remains the same */
.video-categories {
    margin: 40px 0;
}

.categories-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    flex-wrap: wrap;
    gap: 20px;
}

.category-filters {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.category-filter {
    padding: 8px 16px;
    background: rgba(255,255,255,0.1);
    color: var(--light);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 20px;
    cursor: pointer;
    transition: var(--transition);
    font-size: 14px;
    font-weight: 500;
}

.category-filter.active,
.category-filter:hover {
    background: var(--primary);
    color: var(--dark);
    border-color: var(--primary);
}

/* Featured Videos */
.featured-videos-section {
    margin: 60px 0;
}

.featured-videos-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
    gap: 30px;
    margin-top: 30px;
}

.featured-video-card {
    background: var(--card-bg);
    border-radius: 15px;
    overflow: hidden;
    transition: var(--transition);
    border: 1px solid rgba(255,255,255,0.1);
}

.featured-video-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.3);
}

.video-thumbnail-large {
    position: relative;
    width: 100%;
    height: 250px;
    overflow: hidden;
}

.video-thumbnail-large img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: var(--transition);
}

.featured-video-card:hover .video-thumbnail-large img {
    transform: scale(1.05);
}

.video-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.3);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: var(--transition);
}

.video-thumbnail-large:hover .video-overlay {
    opacity: 1;
}

.play-button-large {
    width: 70px;
    height: 70px;
    background: var(--primary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: var(--transition);
    transform: scale(0.8);
}

.video-thumbnail-large:hover .play-button-large {
    transform: scale(1);
}

.play-button-large i {
    color: white;
    font-size: 24px;
    margin-left: 4px;
}

.video-duration {
    position: absolute;
    bottom: 15px;
    right: 15px;
    background: rgba(0,0,0,0.8);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
}

.video-info-large {
    padding: 25px;
}

.video-title {
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--light);
    margin-bottom: 10px;
    line-height: 1.3;
}

.video-description {
    color: var(--gray);
    line-height: 1.5;
    margin-bottom: 15px;
    font-size: 14px;
}

.video-meta {
    display: flex;
    gap: 20px;
    margin-bottom: 15px;
    font-size: 13px;
    color: var(--gray);
}

.video-meta span {
    display: flex;
    align-items: center;
    gap: 5px;
}

.video-actions {
    display: flex;
    gap: 10px;
}

.video-action-btn {
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.2);
    color: var(--light);
    padding: 8px 15px;
    border-radius: 20px;
    cursor: pointer;
    transition: var(--transition);
    font-size: 13px;
    display: flex;
    align-items: center;
    gap: 5px;
}

.video-action-btn:hover {
    background: var(--primary);
    color: var(--dark);
    border-color: var(--primary);
}

/* All Videos Grid */
.all-videos-section {
    margin: 60px 0;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    flex-wrap: wrap;
    gap: 20px;
}

.sort-options select {
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    padding: 8px 12px;
    color: var(--light);
    font-size: 14px;
    outline: none;
    cursor: pointer;
}

.sort-options select:focus {
    border-color: var(--primary);
}

.videos-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 25px;
}

.video-card {
    background: var(--card-bg);
    border-radius: 12px;
    overflow: hidden;
    transition: var(--transition);
    border: 1px solid rgba(255,255,255,0.1);
}

.video-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(0,0,0,0.2);
}

.video-thumbnail {
    position: relative;
    width: 100%;
    height: 180px;
    overflow: hidden;
}

.video-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: var(--transition);
}

.video-card:hover .video-thumbnail img {
    transform: scale(1.05);
}

.play-button {
    width: 50px;
    height: 50px;
    background: var(--primary);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: var(--transition);
    transform: scale(0.8);
}

.video-thumbnail:hover .play-button {
    transform: scale(1);
}

.play-button i {
    color: white;
    font-size: 18px;
    margin-left: 3px;
}

.featured-badge {
    position: absolute;
    top: 10px;
    left: 10px;
    background: var(--secondary);
    color: white;
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 4px;
}

.video-info {
    padding: 20px;
}

.video-info .video-title {
    font-size: 1rem;
    margin-bottom: 8px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.video-info .video-description {
    font-size: 13px;
    margin-bottom: 12px;
}

.video-info .video-meta {
    margin-bottom: 0;
    font-size: 12px;
}

/* Video Artists */
.video-artists {
    margin: 60px 0;
}

.artists-carousel {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 30px;
}

.artist-video-card {
    background: var(--card-bg);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    transition: var(--transition);
    border: 1px solid rgba(255,255,255,0.1);
}

.artist-video-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
}

.artist-image {
    width: 80px;
    height: 80px;
    margin: 0 auto 15px;
    border-radius: 50%;
    overflow: hidden;
}

.artist-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.artist-placeholder {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 24px;
}

.artist-info h5 {
    color: var(--light);
    margin-bottom: 5px;
    font-size: 1rem;
}

.artist-info p {
    color: var(--gray);
    font-size: 13px;
    margin-bottom: 15px;
}

.view-artist-btn {
    background: var(--primary);
    color: white;
    border: none;
    padding: 6px 12px;
    border-radius: 15px;
    cursor: pointer;
    transition: var(--transition);
    font-size: 12px;
    font-weight: 600;
}

.view-artist-btn:hover {
    background: var(--primary-dark);
    transform: translateY(-2px);
}

/* No Videos State */
.no-videos {
    text-align: center;
    padding: 60px 20px;
    color: var(--gray);
    grid-column: 1 / -1;
}

.no-videos i {
    font-size: 48px;
    margin-bottom: 15px;
    opacity: 0.5;
}

.no-videos h4 {
    margin-bottom: 10px;
    color: var(--light);
}

/* Load More Button */
.load-more-videos {
    text-align: center;
    margin-top: 40px;
}

.load-more-btn {
    background: rgba(255,255,255,0.1);
    color: var(--light);
    border: 1px solid rgba(255,255,255,0.2);
    padding: 12px 25px;
    border-radius: 25px;
    cursor: pointer;
    transition: var(--transition);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 0 auto;
}

.load-more-btn:hover {
    background: rgba(255,255,255,0.2);
    transform: translateY(-2px);
}

/* Video Player Modal */
.video-player-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    z-index: 4000;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.video-player-container {
    background: var(--card-bg);
    border-radius: 15px;
    width: 100%;
    max-width: 900px;
    max-height: 90vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.video-player-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

.video-player-header h3 {
    color: var(--light);
    margin: 0;
    font-size: 1.3rem;
}

.close-player-btn {
    background: none;
    border: none;
    color: var(--gray);
    font-size: 20px;
    cursor: pointer;
    transition: var(--transition);
    padding: 5px;
    border-radius: 50%;
}

.close-player-btn:hover {
    color: var(--light);
    background: rgba(255,255,255,0.1);
}

.video-player-content {
    display: flex;
    flex-direction: column;
    flex: 1;
    overflow: hidden;
}

.youtube-player-container {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%; /* 16:9 aspect ratio */
    height: 0;
}

.youtube-player-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.video-player-info {
    padding: 20px;
    max-height: 200px;
    overflow-y: auto;
}

.player-actions {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
    flex-wrap: wrap;
}

.player-action-btn {
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.2);
    color: var(--light);
    padding: 8px 15px;
    border-radius: 20px;
    cursor: pointer;
    transition: var(--transition);
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.player-action-btn:hover {
    background: var(--primary);
    color: var(--dark);
    border-color: var(--primary);
}

.video-description-full {
    color: var(--gray);
    line-height: 1.5;
    font-size: 14px;
}

/* Share Modal */
.share-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 5000;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.share-modal-content {
    background: var(--card-bg);
    border-radius: 15px;
    width: 100%;
    max-width: 400px;
    overflow: hidden;
}

.share-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
}

.share-modal-header h4 {
    color: var(--light);
    margin: 0;
}

.close-share-btn {
    background: none;
    border: none;
    color: var(--gray);
    font-size: 18px;
    cursor: pointer;
    transition: var(--transition);
    padding: 5px;
    border-radius: 50%;
}

.close-share-btn:hover {
    color: var(--light);
    background: rgba(255,255,255,0.1);
}

.share-options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    padding: 20px;
}

.share-option {
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.2);
    color: var(--light);
    padding: 12px 15px;
    border-radius: 10px;
    cursor: pointer;
    transition: var(--transition);
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
}

.share-option:hover {
    transform: translateY(-2px);
}

.share-option.facebook {
    background: #3b5998;
    border-color: #3b5998;
}

.share-option.twitter {
    background: #1da1f2;
    border-color: #1da1f2;
}

.share-option.whatsapp {
    background: #25d366;
    border-color: #25d366;
}

.share-option.copy-link {
    background: var(--primary);
    border-color: var(--primary);
}

.share-link-container {
    display: flex;
    padding: 0 20px 20px;
    gap: 10px;
}

.share-link-container input {
    flex: 1;
    background: rgba(255,255,255,0.1);
    border: 1px solid rgba(255,255,255,0.2);
    border-radius: 8px;
    padding: 10px 15px;
    color: var(--light);
    font-size: 14px;
    outline: none;
}

.copy-btn {
    background: var(--primary);
    border: none;
    color: white;
    padding: 10px 15px;
    border-radius: 8px;
    cursor: pointer;
    transition: var(--transition);
}

.copy-btn:hover {
    background: var(--primary-dark);
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .hero-video-section {
        height: 70vh;
        min-height: 500px;
    }
    
    .categories-header,
    .section-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .featured-videos-grid {
        grid-template-columns: 1fr;
    }
    
    .videos-grid {
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
    }
    
    .video-player-container {
        margin: 10px;
    }
    
    .share-options {
        grid-template-columns: 1fr;
    }
    
    .artists-carousel {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    }
}

@media (max-width: 480px) {
    .hero-video-section {
        height: 60vh;
        min-height: 400px;
    }
    
    .video-thumbnail-large {
        height: 200px;
    }
    
    .video-info-large {
        padding: 20px;
    }
    
    .video-info {
        padding: 15px;
    }
    
    .video-meta {
        flex-direction: column;
        gap: 8px;
    }
    
    .search-videos .search-bar {
        padding: 12px 20px;
    }
}

/* Performance optimizations for video background */
@media (prefers-reduced-motion: reduce) {
    .hero-video-bg {
        display: none;
    }
    
    .hero-video-section {
        background: linear-gradient(135deg, var(--primary), var(--secondary));
    }
}

/* Touch device optimizations */
@media (hover: none) {
    .video-control-btn {
        background: rgba(255, 255, 255, 0.3);
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
// Hero Video Controls
let isVideoPlaying = true;
const heroVideo = document.querySelector('.hero-video-bg');

function toggleHeroVideo() {
    const icon = document.getElementById('videoControlIcon');
    const text = document.getElementById('videoControlText');
    
    if (isVideoPlaying) {
        heroVideo.pause();
        icon.className = 'fas fa-play';
        text.textContent = 'Play Background';
    } else {
        heroVideo.play();
        icon.className = 'fas fa-pause';
        text.textContent = 'Pause Background';
    }
    
    isVideoPlaying = !isVideoPlaying;
}

// Pause video when page is not visible (for performance)
document.addEventListener('visibilitychange', function() {
    if (document.hidden && heroVideo) {
        heroVideo.pause();
    } else if (heroVideo && isVideoPlaying) {
        heroVideo.play();
    }
});

// Rest of your existing JavaScript remains the same
let currentVideoId = '';
let currentVideoTitle = '';

// Video Player Functions
function playVideo(videoId, title) {
    currentVideoId = videoId;
    currentVideoTitle = title;
    
    const modal = document.getElementById('video-player-modal');
    const iframe = document.getElementById('youtube-player');
    const titleElement = document.getElementById('video-player-title');
    
    titleElement.textContent = title;
    iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0`;
    modal.style.display = 'flex';
    
    // Track video play
    trackVideoPlay(videoId);
}

function playFeaturedVideo(videoId, title) {
    playVideo(videoId, title);
}

function closeVideoPlayer() {
    const modal = document.getElementById('video-player-modal');
    const iframe = document.getElementById('youtube-player');
    
    iframe.src = '';
    modal.style.display = 'none';
    
    // Pause video when modal closes
    stopVideo();
}

function stopVideo() {
    const iframe = document.getElementById('youtube-player');
    iframe.src = iframe.src.replace('&autoplay=1', '') + '&autoplay=0';
}

// Share Functions
function shareVideo(videoId, title) {
    currentVideoId = videoId;
    currentVideoTitle = title;
    
    const modal = document.getElementById('share-modal');
    const linkInput = document.getElementById('share-link-input');
    
    const videoUrl = `https://www.youtube.com/watch?v=${videoId}`;
    linkInput.value = videoUrl;
    
    modal.style.display = 'flex';
}

function closeShareModal() {
    const modal = document.getElementById('share-modal');
    modal.style.display = 'none';
}

function shareOnFacebook() {
    const url = encodeURIComponent(`https://www.youtube.com/watch?v=${currentVideoId}`);
    const title = encodeURIComponent(currentVideoTitle);
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${title}`, '_blank');
}

function shareOnTwitter() {
    const url = encodeURIComponent(`https://www.youtube.com/watch?v=${currentVideoId}`);
    const text = encodeURIComponent(`Watch: ${currentVideoTitle}`);
    window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, '_blank');
}

function shareOnWhatsApp() {
    const url = encodeURIComponent(`https://www.youtube.com/watch?v=${currentVideoId}`);
    const text = encodeURIComponent(`Watch: ${currentVideoTitle}`);
    window.open(`https://wa.me/?text=${text}%20${url}`, '_blank');
}

function copyVideoLink() {
    const linkInput = document.getElementById('share-link-input');
    linkInput.select();
    linkInput.setSelectionRange(0, 99999);
    
    navigator.clipboard.writeText(linkInput.value).then(() => {
        showNotification('Link copied to clipboard!', 'success');
    }).catch(err => {
        console.error('Failed to copy: ', err);
        showNotification('Failed to copy link', 'error');
    });
}

function shareCurrentVideo() {
    shareVideo(currentVideoId, currentVideoTitle);
}

// Video Filtering and Sorting
function filterVideos() {
    const searchTerm = document.getElementById('video-search').value.toLowerCase();
    const videos = document.querySelectorAll('.video-card, .featured-video-card');
    
    videos.forEach(video => {
        const title = video.dataset.title;
        if (title.includes(searchTerm)) {
            video.style.display = 'block';
        } else {
            video.style.display = 'none';
        }
    });
}

function sortVideos(sortBy) {
    const videosGrid = document.getElementById('videos-grid');
    const videos = Array.from(videosGrid.querySelectorAll('.video-card'));
    
    videos.sort((a, b) => {
        switch (sortBy) {
            case 'newest':
                return new Date(b.dataset.date) - new Date(a.dataset.date);
            case 'oldest':
                return new Date(a.dataset.date) - new Date(b.dataset.date);
            case 'popular':
                return parseInt(b.dataset.views) - parseInt(a.dataset.views);
            case 'title':
                return a.dataset.title.localeCompare(b.dataset.title);
            default:
                return 0;
        }
    });
    
    // Clear and re-append sorted videos
    videosGrid.innerHTML = '';
    videos.forEach(video => videosGrid.appendChild(video));
}

// Category Filtering
document.addEventListener('DOMContentLoaded', function() {
    const categoryFilters = document.querySelectorAll('.category-filter');
    
    categoryFilters.forEach(filter => {
        filter.addEventListener('click', function() {
            const category = this.dataset.category;
            
            // Update active filter
            categoryFilters.forEach(f => f.classList.remove('active'));
            this.classList.add('active');
            
            // Filter videos
            const videos = document.querySelectorAll('.video-card, .featured-video-card');
            
            videos.forEach(video => {
                if (category === 'all' || video.dataset.category === category) {
                    video.style.display = 'block';
                } else {
                    video.style.display = 'none';
                }
            });
        });
    });
    
    // Close modals when clicking outside
    const videoModal = document.getElementById('video-player-modal');
    const shareModal = document.getElementById('share-modal');
    
    videoModal.addEventListener('click', function(e) {
        if (e.target === this) {
            closeVideoPlayer();
        }
    });
    
    shareModal.addEventListener('click', function(e) {
        if (e.target === this) {
            closeShareModal();
        }
    });
    
    // Close modals with Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeVideoPlayer();
            closeShareModal();
        }
    });
});

// Video Tracking
function trackVideoPlay(videoId) {
    fetch('/api/track-video-play/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify({
            video_id: videoId,
            timestamp: new Date().toISOString()
        })
    }).catch(error => console.error('Error tracking video play:', error));
}

function likeVideo(videoId) {
    fetch('/api/like-video/', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify({
            video_id: videoId
        })
    }).then(response => response.json())
      .then(data => {
          if (data.success) {
              showNotification('Video liked!', 'success');
          }
      })
      .catch(error => console.error('Error liking video:', error));
}

function loadMoreVideos() {
    const button = document.querySelector('.load-more-btn');
    const spinner = document.getElementById('load-more-spinner');
    
    button.disabled = true;
    spinner.style.display = 'inline-block';
    
    // Simulate loading
    setTimeout(() => {
        showNotification('More videos loaded!', 'success');
        button.disabled = false;
        spinner.style.display = 'none';
        // In a real app, you would fetch next page from server
    }, 1500);
}

function viewArtist(artistId) {
    window.location.href = `/artist/${artistId}/`;
}

function downloadVideo() {
    showNotification('Video download feature coming soon!', 'info');
}

// Utility Functions
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `alert alert-${type}`;
    notification.textContent = message;
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 20px;
        border-radius: 8px;
        color: white;
        font-weight: 500;
        z-index: 10000;
        background: ${type === 'success' ? 'var(--primary)' : type === 'error' ? '#dc3545' : '#17a2b8'};
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    `;
    
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.remove();
    }, 3000);
}
</script>
{% endblock %}